// (c)2009 The Wojo Group / Brett Wejrowski

var a,NextId=1,Custom="Custom",GoogleCheckout="GoogleCheckout",PayPal="PayPal",Email="Email",AustralianDollar=AUD="AUD",CanadianDollar=CAD="CAD",CzechKoruna=CZK="CZK",DanishKrone=DKK="DKK",Euro=EUR="EUR",HongKongDollar=HKD="HKD",HungarianForint=HUF="HUF",IsraeliNewSheqel=ILS="ILS",JapaneseYen=JPY="JPY",MexicanPeso=MXN="MXN",NorwegianKrone=NOK="NOK",NewZealandDollar=NZD="NZD",PolishZloty=PLN="PLN",PoundSterling=GBP="GBP",SingaporeDollar=SGD="SGD",SwedishKrona=SEK="SEK",SwissFranc=CHF="CHF",USDollar=
USD="USD",English={PRICE:"price",QUANTITY:"quantity",TOTAL:"total"},PRICE="price",TOTAL="total",QUANTITY="quantity";function setLanguage(c){PRICE=c.PRICE.toLowerCase();QUANTITY=c.QUANTITY.toLowerCase();TOTAL=c.TOTAL.toLowerCase()}
function Cart(){var c=this;c.Version="2.0.1";c.Shelf=new Shelf;c.items={};c.isLoaded=false;c.pageIsReady=false;c[QUANTITY]=0;c[TOTAL]=0;c.taxRate=0;c.taxCost=0;c.shippingFlatRate=0;c.shippingTotalRate=0;c.shippingQuantityRate=0;c.shippingRate=0;c.shippingCost=0;c.currency=USD;c.checkoutTo=PayPal;c.email="";c.merchantId="";c.cartHeaders=["Name","Price","Quantiy","Total"];c.add=function(){var b=this;if(!b.pageIsReady){b.initializeView();b.update()}if(!b.isLoaded){b.load();b.update()}var d=new CartItem;
if(!arguments||arguments.length===0)error("No values passed for item.");else{var e=arguments;if(arguments[0]&&typeof arguments[0]!="string"&&typeof arguments[0]!="number")e=arguments[0];d.parseValuesFromArray(e);d.checkQuantityAndPrice();if(b.hasItem(d)){e=b.hasItem(d);b.items[e][QUANTITY]=parseInt(b.items[e][QUANTITY],10)+parseInt(d[QUANTITY],10)}else b.items[d.id]=d;b.update()}};c.remove=function(b){var d={};for(var e in this.items)if(e!=b)d[e]=this.items[e];this.items=d};c.empty=function(){simpleCart.items=
{};simpleCart.update()};c.find=function(b){if(!b)return null;var d=[];for(var e in c.items){var f=c.items[e],g=true;for(var i in b)if(!f[i]||f[i]!=b[i])g=false;g&&d.push(c.next)}return d.length==0?null:d};c.checkout=function(){if(simpleCart[QUANTITY]===0)error("Cart is empty");else switch(simpleCart.checkoutTo){case PayPal:simpleCart.paypalCheckout();break;case GoogleCheckout:simpleCart.googleCheckout();break;case Email:simpleCart.emailCheckout();break;default:simpleCart.customCheckout();break}};
c.paypalCheckout=function(){var b=this,d="scrollbars,location,resizable,status",e="https://www.paypal.com/cgi-bin/webscr?cmd=_cart&upload=1&business="+b.email+"&currency_code="+b.currency,f=1,g="";b=this;if(b.taxRate)e=e+"&tax_cart="+b.currencyStringForPaypalCheckout(b.taxCost);for(var i in b.items){var h=b.items[i],k="";for(var j in h)if(typeof h[j]!="function"&&j!="id"&&j!=PRICE&&j!=QUANTITY&&j!="name"&&j!="shipping")k=k+", "+j+"="+h[j];k=k.substring(2);g=g+"&item_name_"+f+"="+h.name+"&item_number_"+
f+"="+f+"&quantity_"+f+"="+h[QUANTITY]+"&amount_"+f+"="+b.currencyStringForPaypalCheckout(h[PRICE])+"&on0_"+f+"=Options&os0_"+f+"="+k;f++}if(b.shipping()!=0)g=g+"&item_name_"+f+"=Shipping&item_number_"+f+"="+f+"&quantity_"+f+"=1&amount_"+f+"="+b.currencyStringForPaypalCheckout(b.shippingCost);e+=g;window.open(e,"paypal",d)};c.googleCheckout=function(){var b=this;if(b.currency!=USD&&b.currency!=GBP)error("Google Checkout only allows the USD and GBP for currency.");else if(b.merchantId===""||b.merchantId===
null||!b.merchantId)error("No merchant Id for google checkout supplied.");else{var d=document.createElement("form"),e=1;d.style.display="none";d.method="POST";d.action="https://checkout.google.com/api/checkout/v2/checkoutForm/Merchant/"+b.merchantId;d.acceptCharset="utf-8";for(var f in b.items){var g=b.items[f];d.appendChild(b.createHiddenElement("item_name_"+e,g.name));d.appendChild(b.createHiddenElement("item_quantity_"+e,g[QUANTITY]));d.appendChild(b.createHiddenElement("item_price_"+e,g[PRICE]));
d.appendChild(b.createHiddenElement("item_currency_"+e,b.currency));d.appendChild(b.createHiddenElement("item_tax_rate_"+e,b.taxRate));d.appendChild(b.createHiddenElement("_charset_",""));var i="";for(var h in g)if(typeof g[h]!="function"&&h!="id"&&h!=QUANTITY&&h!=PRICE)i=i+", "+h+": "+g[h];i=i.substring(1);d.appendChild(b.createHiddenElement("item_description_"+e,i));e++}document.body.appendChild(d);d.submit();document.body.removeChild(d)}};c.emailCheckout=function(){};c.customCheckout=function(){};
c.load=function(){var b=this;b.items={};b[TOTAL]=0;b[QUANTITY]=0;if(readCookie("simpleCart"))for(var d=unescape(readCookie("simpleCart")).split("++"),e=0,f=d.length;e<f;e++){var g=d[e].split("||"),i=new CartItem;if(i.parseValuesFromArray(g)){i.checkQuantityAndPrice();b.items[i.id]=i}}b.isLoaded=true};c.save=function(){var b="";for(var d in this.items)b=b+"++"+this.items[d].print();createCookie("simpleCart",b.substring(2),30)};c.initializeView=function(){var b=this;b.totalOutlets=getElementsByClassName("simpleCart_"+
TOTAL);b.quantityOutlets=getElementsByClassName("simpleCart_"+QUANTITY);b.cartDivs=getElementsByClassName("simpleCart_items");b.taxCostOutlets=getElementsByClassName("simpleCart_taxCost");b.taxRateOutlets=getElementsByClassName("simpleCart_taxRate");b.shippingCostOutlets=getElementsByClassName("simpleCart_shippingCost");b.finalTotalOutlets=getElementsByClassName("simpleCart_finalTotal");b.addEventToArray(getElementsByClassName("simpleCart_checkout"),simpleCart.checkout,"click");b.addEventToArray(getElementsByClassName("simpleCart_empty"),
simpleCart.empty,"click");b.Shelf.readPage();b.pageIsReady=true};c.updateView=function(){c.updateViewTotals();c.cartDivs&&c.cartDivs.length>0&&c.updateCartView()};c.updateViewTotals=function(){for(var b=[[QUANTITY,"none"],[TOTAL,"currency"],["shippingCost","currency"],["taxCost","currency"],["taxRate","percentage"],["finalTotal","currency"]],d=0,e=b.length;d<e;d++){var f=b[d][0]+"Outlets",g;for(var i in c[f]){switch(b[d][1]){case "none":g=""+c[b[d][0]];break;case "currency":g=c.valueToCurrencyString(c[b[d][0]]);
break;case "percentage":g=c.valueToPercentageString(c[b[d][0]]);break;default:g=""+c[b[d][0]];break}c[f][i].innerHTML=""+g}}};c.updateCartView=function(){var b=[],d,e,f,g,i,h,k,j,l;e=document.createElement("div");for(i in c.cartHeaders){h=document.createElement("div");f=c.cartHeaders[i].split("_");h.innerHTML=f[0];h.className="item"+f[0];d=1;for(xlen=f.length;d<xlen;d++)if(f[d].toLowerCase()=="noheader")h.style.display="none";e.appendChild(h)}e.className="cartHeaders";b[0]=e;d=1;for(g in c.items){e=
document.createElement("div");f=c.items[g];for(i in c.cartHeaders){h=document.createElement("div");k=c.cartHeaders[i].split("_");switch(k[0].toLowerCase()){case TOTAL:j=c.valueToCurrencyString(parseFloat(f[PRICE])*parseInt(f[QUANTITY],10));break;case "increment":j=c.valueToLink("+","javascript:;","onclick=\"simpleCart.items['"+f.id+"'].increment();\"");break;case "decrement":j=c.valueToLink("-","javascript:;","onclick=\"simpleCart.items['"+f.id+"'].decrement();\"");break;case "remove":j=c.valueToLink("Remove",
"javascript:;","onclick=\"simpleCart.items['"+f.id+"'].remove();\"");break;case PRICE:j=c.valueToCurrencyString(f[k[0].toLowerCase()]?f[k[0].toLowerCase()]:" ");break;default:j=f[k[0].toLowerCase()]?f[k[0].toLowerCase()]:" ";break}for(var m=1,n=k.length;m<n;m++){l=k[m].toLowerCase();switch(l){case "image":case "img":j=c.valueToImageString(j);break;case "input":j=c.valueToTextInput(j,"onchange=\"simpleCart.items['"+f.id+"'].set('"+j+"' , this.value);\"");break;case "div":case "span":case "h1":case "h2":case "h3":case "h4":case "p":j=
c.valueToElement(l,j,"");break;case "noheader":break;default:error("unkown header option: "+l);break}}h.innerHTML=j;h.className="item"+k[0];e.appendChild(h)}e.className="itemContainer";b[d]=e;d++}for(g in c.cartDivs){for(d=c.cartDivs[g];d.childNodes[0];)d.removeChild(d.childNodes[0]);e=0;for(i=b.length;e<i;e++)d.appendChild(b[e])}};c.addEventToArray=function(b,d,e){for(var f in b){var g=b[f];if(g.addEventListener)g.addEventListener(e,d,false);else g.attachEvent&&g.attachEvent("on"+e,d)}};c.createHiddenElement=
function(b,d){var e=document.createElement("input");e.type="hidden";e.name=b;e.value=d;return e};c.currencySymbol=function(){switch(c.currency){case JPY:return"&yen;";case EUR:return"&euro;";case GBP:return"&pound;";case USD:case CAD:case AUD:case NZD:case HKD:case SGD:return"&#36;";default:return""}};c.currencyStringForPaypalCheckout=function(b){return c.currencySymbol()=="&#36;"?"$"+parseFloat(b).toFixed(2):""+parseFloat(b).toFixed(2)};c.valueToCurrencyString=function(b){return parseFloat(b).toCurrency(c.currencySymbol())};
c.valueToPercentageString=function(b){return parseFloat(100*b)+"%"};c.valueToImageString=function(b){return b.match(/<\s*img.*src\=/)?b:'<img src="'+b+'" />'};c.valueToTextInput=function(b,d){return'<input type="text" value="'+b+'" '+d+" />"};c.valueToLink=function(b,d,e){return'<a href="'+d+'" '+e+" >"+b+"</a>"};c.valueToElement=function(b,d,e){return"<"+b+" "+e+" > "+d+"</"+b+">"};c.hasItem=function(b){for(var d in c.items){var e=c.items[d],f=true;for(var g in b)if(typeof b[g]!="function"&&g!="quantity"&&
g!="id")if(b[g]!=e[g])f=false;if(f)return d}return false};c.update=function(){simpleCart.isLoaded||simpleCart.load();simpleCart.pageIsReady||simpleCart.initializeView();c.updateTotals();c.updateView();c.save()};c.updateTotals=function(){c[TOTAL]=0;c[QUANTITY]=0;for(var b in c.items){var d=c.items[b];if(d[QUANTITY]<1)d.remove();else if(d[QUANTITY]!==null&&d[QUANTITY]!="undefined")c[QUANTITY]=parseInt(c[QUANTITY],10)+parseInt(d[QUANTITY],10);if(d[PRICE])c[TOTAL]=parseFloat(c[TOTAL])+parseInt(d[QUANTITY],
10)*parseFloat(d[PRICE])}c.shippingCost=c.shipping();c.taxCost=parseFloat(c[TOTAL])*c.taxRate;c.finalTotal=c.shippingCost+c.taxCost+c[TOTAL]};c.shipping=function(){if(parseInt(c[QUANTITY],10)===0)return 0;var b=parseFloat(c.shippingFlatRate)+parseFloat(c.shippingTotalRate)*parseFloat(c[TOTAL])+parseFloat(c.shippingQuantityRate)*parseInt(c[QUANTITY],10),d,e;for(e in c.items){d=c.items[e];if(d.shipping)b+=typeof d.shipping=="function"?parseFloat(d.shipping()):parseFloat(d.shipping)}return b};c.initialize=
function(){simpleCart.initializeView();simpleCart.load();simpleCart.update()}}function CartItem(){this.id="c"+NextId++}a=CartItem.prototype;
a.set=function(c,b){c=c.toLowerCase();if(typeof this[c]!="function"&&c!="id"){if(c==QUANTITY){b=b.replace(/[^(\d|\.)]*/gi,"");b=b.replace(/,*/gi,"");b=parseInt(b,10)}else if(c==PRICE){b=b.replace(/[^(\d|\.)]*/gi,"");b=b.replace(/,*/gi,"");b=parseFloat(b)}if(typeof b=="number"&&isNaN(b))error("Improperly formatted input.");else{this[c]=b;this.checkQuantityAndPrice()}}else error("Cannot change "+c+", this is a reserved field.");simpleCart.update()};
a.increment=function(){this[QUANTITY]=parseInt(this[QUANTITY],10)+1;simpleCart.update()};a.decrement=function(){if(parseInt(this[QUANTITY],10)<2)this.remove();else{this[QUANTITY]=parseInt(this[QUANTITY],10)-1;simpleCart.update()}};a.print=function(){var c="";for(var b in this)if(typeof this[b]!="function")c+=escape(b)+"="+escape(this[b])+"||";return c.substring(0,c.length-2)};
a.checkQuantityAndPrice=function(){if(!this[PRICE]||this[QUANTITY]==null||this[QUANTITY]=="undefined"){this[QUANTITY]=1;error("No quantity for item.")}else{this[QUANTITY]=(""+this[QUANTITY]).replace(/,*/gi,"");this[QUANTITY]=parseInt((""+this[QUANTITY]).replace(/[^(\d|\.)]*/gi,""),10);if(isNaN(this[QUANTITY])){error("Quantity is not a number.");this[QUANTITY]=1}}if(!this[PRICE]||this[PRICE]==null||this[PRICE]=="undefined"){this[PRICE]=0;error("No price for item or price not properly formatted.")}else{this[PRICE]=
(""+this[PRICE]).replace(/,*/gi,"");this[PRICE]=parseFloat((""+this[PRICE]).replace(/[^(\d|\.)]*/gi,""));if(isNaN(this[PRICE])){error("Price is not a number.");this[PRICE]=0}}};a.parseValuesFromArray=function(c){if(c&&c.length&&c.length>0){for(var b=0,d=c.length;b<d;b++){c[b].replace(/||/,"| |");c[b].replace(/\+\+/,"+ +");var e=c[b].split("=");if(e.length>1){if(e.length>2)for(var f=2,g=e.length;f<g;f++)e[1]=e[1]+"="+e[f];this[unescape(e[0]).toLowerCase()]=unescape(e[1])}}return true}else return false};
a.remove=function(){simpleCart.remove(this.id);simpleCart.update()};function Shelf(){this.items={}}Shelf.prototype.readPage=function(){this.items={};var c=getElementsByClassName("simpleCart_shelfItem");for(var b in c){var d=new ShelfItem;this.checkChildren(c[b],d);this.items[d.id]=d}};
Shelf.prototype.checkChildren=function(c,b){for(var d=0;c.childNodes[d];d++){var e=c.childNodes[d];if(e.className&&e.className.match(/item_[^ ]+/)){var f=/item_[^ ]+/.exec(e.className)[0].split("_");if(f[1]=="add"||f[1]=="Add"){f=[];f.push(e);var g=simpleCart.Shelf.addToCart(b.id);simpleCart.addEventToArray(f,g,"click");e.id=b.id}else b[f[1]]=e}e.childNodes[0]&&this.checkChildren(e,b)}};Shelf.prototype.empty=function(){this.items={}};
Shelf.prototype.addToCart=function(c){return function(){simpleCart.Shelf.items[c]?simpleCart.Shelf.items[c].addToCart():error("Shelf item with id of "+c+" does not exist.")}};function ShelfItem(){this.id="s"+NextId++}ShelfItem.prototype.remove=function(){simpleCart.Shelf.items[this.id]=null};
ShelfItem.prototype.addToCart=function(){var c=[],b;for(var d in this)if(typeof this[d]!="function"&&d!="id"){b="";switch(d){case PRICE:if(this[d].value)b=this[d].value;else if(this[d].innerHTML)b=this[d].innerHTML;b=b.replace(/[^(\d|\.)]*/gi,"");b=b.replace(/,*/,"");break;case "image":b=this[d].src;break;default:b=this[d].value?this[d].value:this[d].innerHTML?this[d].innerHTML:this[d].src?this[d].src:this[d];break}c.push(d+"="+b)}simpleCart.add(c)};
function createCookie(c,b,d){if(d){var e=new Date;e.setTime(e.getTime()+d*24*60*60*1E3);d="; expires="+e.toGMTString()}else d="";document.cookie=c+"="+b+d+"; path=/"}function readCookie(c){c=c+"=";for(var b=document.cookie.split(";"),d=0;d<b.length;d++){for(var e=b[d];e.charAt(0)==" ";)e=e.substring(1,e.length);if(e.indexOf(c)===0)return e.substring(c.length,e.length)}return null}function eraseCookie(c){createCookie(c,"",-1)}
function getElementsByClassName(c,b,d){getElementsByClassName=document.getElementsByClassName?function(e,f,g){g=g||document;e=g.getElementsByClassName(e);f=f?new RegExp("\\b"+f+"\\b","i"):null;g=[];for(var i,h=0,k=e.length;h<k;h+=1){i=e[h];if(!f||f.test(i.nodeName))g.push(i)}return g}:document.evaluate?function(e,f,g){f=f||"*";g=g||document;e=e.split(" ");var i="",h="http://www.w3.org/1999/xhtml",k=document.documentElement.namespaceURI===h?h:null;h=[];for(var j,l=0,m=e.length;l<m;l+=1)i+="[contains(concat(' ', @class, ' '), ' "+
e[l]+" ')]";try{j=document.evaluate(".//"+f+i,g,k,0,null)}catch(n){j=document.evaluate(".//"+f+i,g,null,0,null)}for(;f=j.iterateNext();)h.push(f);return h}:function(e,f,g){f=f||"*";g=g||document;var i=e.split(" ");e=[];f=f==="*"&&g.all?g.all:g.getElementsByTagName(f);g=[];var h;h=0;for(var k=i.length;h<k;h+=1)e.push(new RegExp("(^|\\s)"+i[h]+"(\\s|$)"));k=0;for(var j=f.length;k<j;k+=1){i=f[k];h=false;for(var l=0,m=e.length;l<m;l+=1){h=e[l].test(i.className);if(!h)break}h&&g.push(i)}return g};return getElementsByClassName(c,
b,d)}String.prototype.reverse=function(){return this.split("").reverse().join("")};Number.prototype.withCommas=function(){for(var c=6,b=parseFloat(this).toFixed(2).toString().reverse();c<b.length;){b=b.substring(0,c)+","+b.substring(c);c+=4}return b.reverse()};Number.prototype.toCurrency=function(c){return(c?c:"$")+this.withCommas()};function error(c){try{console.log(c)}catch(b){}}var simpleCart=new Cart;
if(typeof jQuery!=="undefined")$(document).ready(function(){simpleCart.initialize()});else if(typeof Prototype!=="undefined")Event.observe(window,"load",function(){simpleCart.initialize()});else window.onload=simpleCart.initialize;